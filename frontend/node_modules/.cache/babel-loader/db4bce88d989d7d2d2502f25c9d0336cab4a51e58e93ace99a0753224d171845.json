{"ast":null,"code":"var _jsxFileName = \"/Users/davisnguyen/projects/crimecompass/frontend/src/components/CrimeMap.tsx\",\n  _s = $RefreshSig$();\n// Import packages\nimport React, { useState, useEffect } from 'react';\nimport { GoogleMap, LoadScript, Marker } from '@react-google-maps/api';\nimport { useDispatch } from 'react-redux';\nimport { setLocation } from '../redux/actions';\nimport '../styles/CrimeMap.css';\nimport ReportForm from '../components/ReportForm';\nimport axios from 'axios';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst mapStyles = [{\n  featureType: \"poi\",\n  elementType: \"labels\",\n  stylers: [{\n    visibility: \"off\"\n  }],\n  disableDoubleClickZoom: true,\n  // Add this line\n  clickableIcons: false\n}];\nconst CrimeMap = () => {\n  _s();\n  const dispatch = useDispatch();\n  const [markerPosition, setMarkerPosition] = useState(null);\n  const [address, setAddress] = useState(\"\"); // String or null value, will be initialized to null when app starts\n  const [map, setMap] = useState(null);\n  const [mapCenter, setMapCenter] = useState({\n    lat: 37.8044,\n    lng: -122.2712\n  }); // Initial center\n\n  const [locations, setLocations] = useState([]);\n  const geocodeLatLng = async (lat, lng) => {\n    const geocoder = new google.maps.Geocoder();\n    const latlng = {\n      lat,\n      lng\n    };\n    return new Promise((resolve, reject) => {\n      geocoder.geocode({\n        location: latlng\n      }, (results, status) => {\n        if (status === \"OK\") {\n          if (results && results[0]) {\n            resolve(results[0].formatted_address);\n          } else {\n            reject(\"No results found\");\n          }\n        } else {\n          reject(\"Geocoder failed due to: \" + status);\n        }\n      });\n    });\n  };\n\n  // Fetch Locations\n  // Use useEffect to fetch data when the component mounts.\n\n  useEffect(() => {\n    const fetchData = async () => {\n      try {\n        const response = await axios.get('http://localhost:5038/todoappcollection');\n        const locationStrings = response.data.map(item => item.location);\n        console.log(locationStrings);\n\n        // Initialize the geocoder object.\n        const geocoder = new google.maps.Geocoder();\n        // Iterate over each location string to geocode them.\n        for (const locationString of locationStrings) {\n          // Use the geocoder to convert the address in lat/lng coordinates\n          geocoder.geocode({\n            address: locationString\n          }, (results, status) => {});\n        }\n      } catch (error) {}\n    };\n    fetchData();\n  }, []);\n  const handleMapClick = async event => {\n    const latitude = event.latLng.lat();\n    const longitude = event.latLng.lng();\n    const newCenter = {\n      lat: latitude,\n      lng: longitude\n    };\n    setMapCenter(newCenter);\n    setMarkerPosition({\n      lat: latitude,\n      lng: longitude\n    });\n    map === null || map === void 0 ? void 0 : map.panTo(new google.maps.LatLng(latitude, longitude));\n    try {\n      const fetchedAddress = await geocodeLatLng(latitude, longitude); // Using await here\n      setAddress(fetchedAddress);\n      dispatch(setLocation(fetchedAddress));\n    } catch (error) {\n      console.error(\"Error getting address:\", error);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"crime-map-wrapper\",\n    children: /*#__PURE__*/_jsxDEV(LoadScript, {\n      googleMapsApiKey: 'AIzaSyCLu25wqirs0pAPnvjvH4hV4Se7Kcpzmps',\n      children: /*#__PURE__*/_jsxDEV(GoogleMap, {\n        mapContainerClassName: \"crime-map-container\",\n        center: mapCenter // Default center (San Francisco)\n        ,\n        zoom: 13,\n        onClick: handleMapClick,\n        onLoad: map => setMap(map),\n        options: {\n          styles: mapStyles,\n          disableDoubleClickZoom: true,\n          mapTypeControl: false,\n          clickableIcons: false\n        },\n        children: [/*#__PURE__*/_jsxDEV(ReportForm, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 127,\n          columnNumber: 21\n        }, this), markerPosition && /*#__PURE__*/_jsxDEV(Marker, {\n          position: markerPosition\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 40\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 111,\n    columnNumber: 9\n  }, this);\n};\n_s(CrimeMap, \"6sHlymqfz48RcMyUbilIlt56aX0=\", false, function () {\n  return [useDispatch];\n});\n_c = CrimeMap;\nexport default CrimeMap;\n\n// Issues to fix after lunch. Fix how it looks in mobile. \n// Setup Database\n// Check for anymore other errors when using. \n// Retype each line of code so you remember how to use it. \nvar _c;\n$RefreshReg$(_c, \"CrimeMap\");","map":{"version":3,"names":["React","useState","useEffect","GoogleMap","LoadScript","Marker","useDispatch","setLocation","ReportForm","axios","jsxDEV","_jsxDEV","mapStyles","featureType","elementType","stylers","visibility","disableDoubleClickZoom","clickableIcons","CrimeMap","_s","dispatch","markerPosition","setMarkerPosition","address","setAddress","map","setMap","mapCenter","setMapCenter","lat","lng","locations","setLocations","geocodeLatLng","geocoder","google","maps","Geocoder","latlng","Promise","resolve","reject","geocode","location","results","status","formatted_address","fetchData","response","get","locationStrings","data","item","console","log","locationString","error","handleMapClick","event","latitude","latLng","longitude","newCenter","panTo","LatLng","fetchedAddress","className","children","googleMapsApiKey","mapContainerClassName","center","zoom","onClick","onLoad","options","styles","mapTypeControl","fileName","_jsxFileName","lineNumber","columnNumber","position","_c","$RefreshReg$"],"sources":["/Users/davisnguyen/projects/crimecompass/frontend/src/components/CrimeMap.tsx"],"sourcesContent":["// Import packages\nimport React, { useState, useEffect } from 'react';\nimport { GoogleMap, LoadScript, Marker } from '@react-google-maps/api';\nimport { useDispatch } from 'react-redux';\nimport { setLocation } from '../redux/actions';\nimport '../styles/CrimeMap.css';\nimport ReportForm from '../components/ReportForm';\nimport axios from 'axios';\n\nconst mapStyles = [\n    {\n        featureType: \"poi\",\n        elementType: \"labels\",\n        stylers: [\n            { visibility: \"off\"}\n        ],\n        disableDoubleClickZoom: true,  // Add this line\n        clickableIcons: false,\n\n    }\n];\n\nconst CrimeMap: React.FC = () => {\n    const dispatch = useDispatch();\n    const [markerPosition, setMarkerPosition] = useState<{ lat: number, lng: number } | null>(null);\n    const [address, setAddress] = useState<string | null>(\"\"); // String or null value, will be initialized to null when app starts\n    const [map, setMap] = useState<google.maps.Map | null>(null);\n\n    const [mapCenter, setMapCenter] = useState({ lat: 37.8044, lng: -122.2712 }); // Initial center\n\n    const [locations, setLocations] = useState<{ lat: number, lng: number}[]>([]);\n\n    const geocodeLatLng = async (lat: number, lng: number) => {\n        const geocoder = new google.maps.Geocoder();\n        const latlng = { lat, lng };\n        return new Promise<string>((resolve, reject) => {\n            geocoder.geocode({ location: latlng }, (results, status) => {\n                if (status === \"OK\") {\n                    if (results && results[0]) {\n                        resolve(results[0].formatted_address);\n                    } else {\n                        reject(\"No results found\");\n                    }\n                } else {\n                    reject(\"Geocoder failed due to: \" + status);\n                }\n            });\n        });\n    };\n\n    // Fetch Locations\n    // Use useEffect to fetch data when the component mounts.\n\n\n    \n    useEffect(() => {\n        const fetchData = async () => {\n            try {\n            const response = await axios.get('http://localhost:5038/todoappcollection');\n            const locationStrings = response.data.map((item:any) => item.location);\n            console.log(locationStrings)\n            \n            // Initialize the geocoder object.\n            const geocoder = new google.maps.Geocoder();\n            // Iterate over each location string to geocode them.\n            for (const locationString of locationStrings) {\n                // Use the geocoder to convert the address in lat/lng coordinates\n                geocoder.geocode({ address: locationString }, (results, status) => {\n                    \n                })\n            }\n\n\n\n            } catch (error) {\n\n            }\n        }\n\n        fetchData();\n    },[])\n    \n\n\n\n\n    \n\n\n    const handleMapClick = async (event: any) => {\n        const latitude = event.latLng.lat();\n        const longitude = event.latLng.lng();\n        const newCenter = {lat: latitude, lng:longitude};\n        setMapCenter(newCenter);\n        setMarkerPosition({ lat: latitude, lng: longitude });\n\n        map?.panTo(new google.maps.LatLng(latitude, longitude));\n    \n        try {\n            const fetchedAddress = await geocodeLatLng(latitude, longitude); // Using await here\n            setAddress(fetchedAddress);\n            dispatch(setLocation(fetchedAddress))\n\n        } catch (error) {\n            console.error(\"Error getting address:\", error);\n        }\n    };\n    \n\n    return (\n        <div className=\"crime-map-wrapper\">\n            <LoadScript googleMapsApiKey={'AIzaSyCLu25wqirs0pAPnvjvH4hV4Se7Kcpzmps'}>\n                \n                <GoogleMap\n                    mapContainerClassName=\"crime-map-container\"\n                    center={mapCenter} // Default center (San Francisco)\n                    zoom={13}\n                    onClick={handleMapClick}\n                    onLoad={map => setMap(map)}\n                    options={{ \n                        styles: mapStyles, \n                        disableDoubleClickZoom: true,\n                        mapTypeControl: false,\n                        clickableIcons: false,\n                    }}\n                >\n                    <ReportForm/>\n                    {markerPosition && <Marker position={markerPosition} />}\n                </GoogleMap>\n            </LoadScript>\n\n        </div>\n    )\n}\nexport default CrimeMap;\n\n\n// Issues to fix after lunch. Fix how it looks in mobile. \n// Setup Database\n// Check for anymore other errors when using. \n// Retype each line of code so you remember how to use it. "],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}